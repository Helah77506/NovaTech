<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Details</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Product Details</h1>
    <a href="product.html" class="back-btn">← Back to Products</a>
  </header>

  <main class="product-detail-container">
    <div class="product-detail-image">
      <img id="detailImage" src="" alt="Product Image" />
    </div>

    <div class="product-detail-info">
      <h2 id="detailName"></h2>
      <p id="detailPrice" class="price"></p>
      <p id="detailDescription"></p>

      <label for="quantity">Quantity:</label>
      <input id="quantity" type="number" min="1" value="1" />

      <button id="addToCartBtn" class="add-cart-btn">Add to Cart</button>
    </div>
  </main>

  <script>
    // Helper: read URL param
    function getParam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    // Get product list from localStorage
    const data = localStorage.getItem("productsData");
    const products = data ? JSON.parse(data) : [];

    const idParam = getParam("id");
    const productId = idParam ? parseInt(idParam, 10) : null;

    const product = products.find(p => p.id === productId);

    if (!product) {
      alert("Product not found.");
      window.location.href = "product.html";
    } else {
      // Populate fields
      document.getElementById("detailImage").src = product.image || "images/placeholder.jpg";
      document.getElementById("detailName").textContent = product.name;
      document.getElementById("detailPrice").textContent = "₦" + product.price.toLocaleString();
      document.getElementById("detailDescription").textContent = product.description;
    }

    // Add to cart logic
    document.getElementById("addToCartBtn").addEventListener("click", () => {
      const qtyInput = document.getElementById("quantity");
      const quantity = parseInt(qtyInput.value, 10);
      if (!quantity || quantity < 1) {
        alert("Quantity must be at least 1");
        return;
      }

      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      // Try to find existing item
      const existing = cart.find(item => item.id === product.id);
      if (existing) {
        existing.quantity += quantity;
      } else {
        cart.push({ ...product, quantity });
      }

      localStorage.setItem("cart", JSON.stringify(cart));
      alert("Added to cart!");
    });
  </script>
</body>
</html>
